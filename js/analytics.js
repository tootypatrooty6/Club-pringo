// @license  magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3.0
window.archive_analytics=function(){var e=window.Date,n=new e;function t(){return"performance"in window&&"timing"in window.performance}function a(){var a;return a=t()?window.performance.timing.domLoading:n.getTime(),(new e).getTime()-a}function i(){return t()?(new e).getTime()-window.performance.timing.navigationStart:null}function r(){var e;if(!("getComputedStyle"in window))return null;var n,t,a,i,r=window.getComputedStyle(document.documentElement);return r?(e=r.fontSize,document.querySelector("#BookReader")?e:(n=e,t=function(e){return 1.6*e},a=parseFloat(n,10),i=n.replace(/(\d*\.\d+)|\d+/,""),t(a)+i)):null}function o(e){var n=document.querySelector("meta[property="+e+"]");return n&&n.getAttribute("content")||null}return{service:o("service"),mediaType:o("mediatype"),primaryCollection:o("primary_collection"),values:{},send_ping:function(e,n,t){void 0!==window.navigator&&void 0!==window.navigator.sendBeacon?this.send_ping_via_beacon(e):this.send_ping_via_image(e)},send_ping_via_beacon:function(e){var n=this.generate_tracking_url(e||{});window.navigator.sendBeacon(n)},send_ping_via_image:function(e){var n=this.generate_tracking_url(e||{}),t=new Image(1,1);t.src=n,t.alt=""},generate_tracking_url:function(e){var n,t=e,a=[];return t.service=t.service||this.service||"ao_2",(n=Object.keys(t)).forEach((function(e){a.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]))})),a.push("version=2"),a.push("count="+(n.length+2)),"//analytics.archive.org/0.gif?"+a.join("&")},send_scroll_fetch_event:function(e){var n={ev:e},t=a(),r=i();t&&(n.loadtime=t),r&&(n.nav_to_done_ms=r),this.send_event("page_action","scroll_fetch",location.pathname,n)},send_scroll_fetch_base_event:function(){var e={},n=a(),t=i();n&&(e.loadtime=n),t&&(e.nav_to_done_ms=t),this.send_event("page_action","scroll_fetch_base",location.pathname,e)},send_pageview:function(n){var t,o=n||{},s=a(),c=o.mediaType,u=o.primaryCollection,d=o.page,g=i();t=r(),this.values.kind="pageview",this.values.timediff=(new e).getTimezoneOffset()/60*-1,this.values.locale=function(){if(navigator){if(navigator.language)return navigator.language;if(navigator.browserLanguage)return navigator.browserLanguage;if(navigator.systemLanguage)return navigator.systemLanguage;if(navigator.userLanguage)return navigator.userLanguage}return""}(),this.values.referrer=""==document.referrer?"-":document.referrer,s&&(this.values.loadtime=s),g&&(this.values.nav_to_done_ms=g),o.trackingId&&(this.values.ga_tid=o.trackingId),t&&(this.values.ga_cd1=t),"devicePixelRatio"in window&&(this.values.ga_cd2=window.devicePixelRatio),c&&(this.values.ga_cd3=c),o.mediaLanguage&&(this.values.ga_cd4=o.mediaLanguage),u&&(this.values.ga_cd5=u),d&&(this.values.page=d),this.send_ping(this.values)},send_event:function(e,n,t,a){t||(t=window.location.pathname),a||(a={}),a.mediaLanguage&&(a.ga_cd4=a.mediaLanguage,delete a.mediaLanguage);var i=Object.assign({kind:"event",ec:e,ea:n,el:t,cache_bust:Math.random()},a);this.send_ping(i)},send_event_no_sampling:function(e,n,t,a){var i=a||{};i.service="ao_no_sampling",this.send_event(e,n,t,i)},send_pageview_on_load:function(e){var n=this;window.addEventListener("load",(function(){n.send_pageview(e)}))},process_url_events:function(e){var n,t,a=function(e){var n,t,a;e||(e=window.location);var i={},r=e.search;if(!r)return i;for(n=r.substring(1).split("&"),t=0;t<n.length;t++)i[(a=n[t].split("="))[0]]=decodeURIComponent(a[1]);return i}(e).iax;a&&(t=(n=a.split("|")).length>=1?n[1]:"",this.send_event_no_sampling(n[0],t,window.location.pathname))},set_up_event_tracking:function(){var e=this;function n(n,a){var i="[data-"+a+"]",r=n.target;if(r){var o,s,c,u=r.closest(i);if(u)(o=u.dataset[t(a)])&&(s=o.split("|"),c=(c=u.dataset[t("event-tracking-options")])?JSON.parse(c):{},e.send_event(s[0],s[1],s[2]||window.location.pathname,c.service?{service:c.service}:{}))}}function t(e){return e.replace(/\W+(.)/g,(function(e,n){return n.toUpperCase()}))}document.addEventListener("click",(function(e){n(e,"event-click-tracking")})),document.addEventListener("submit",(function(e){n(e,"event-form-tracking")}))},get_data_packets:function(){return[this.values]},create_tracking_image:function(e){this.send_ping_via_image({cache_bust:Math.random(),kind:"track_js",track_js_case:e})}}}();
// @license-end